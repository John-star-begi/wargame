<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Class A Fix — Growth War-Gaming</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Roboto font -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">

  <!-- Tailwind (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- React 18 UMD (production) -->
  <script src="https://cdn.jsdelivr.net/npm/react@18/umd/react.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18/umd/react-dom.production.min.js"></script>

  <!-- Babel (so JSX works in this single file) -->
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>

  <!-- PropTypes (Recharts expects this global) -->
  <script src="https://cdn.jsdelivr.net/npm/prop-types@15.8.1/prop-types.min.js"></script>

  <!-- Recharts UMD -->
  <script src="https://cdn.jsdelivr.net/npm/recharts@2.12.7/umd/Recharts.min.js"></script>

  <style>
    :root{
      --c-bg:#F9FBFC; --c-primary:#76CAE3; --c-navy:#1E3A8A; --c-lav:#D9E7F1;
      --c-mint:#42B77E; --c-amber:#FFB84D; --c-coral:#E84855; --c-text:#0f172a;
      --radius:14px; --shadow:0 2px 6px rgba(0,0,0,.05); --shadow-hover:0 6px 18px rgba(0,0,0,.08);
      --gutter:24px; --transition:150ms cubic-bezier(.2,.7,.2,1);
    }
    html,body{height:100%;}
    body{background:var(--c-bg); color:var(--c-text); font-family:"Roboto",system-ui,-apple-system,Segoe UI,Arial,sans-serif;}
    .wrap{ padding:16px; } @media(min-width:768px){ .wrap{ padding:var(--gutter);} }
    .ui-card{background:#fff;border-radius:14px;box-shadow:var(--shadow);transition:transform var(--transition),box-shadow var(--transition);}
    .ui-card:hover{box-shadow:var(--shadow-hover);}
    .ui-title{font-weight:700;font-size:22px;color:var(--c-navy);}
    .ui-sub{font-weight:500;font-size:16px;color:#475569;}
    .ui-body{font-size:14px;color:#475569;}
    .btn{position:relative;overflow:hidden;display:inline-flex;align-items:center;gap:.5rem;border:none;border-radius:12px;padding:.625rem 1rem;font-weight:600;transition:transform var(--transition);}
    .btn:hover{transform:scale(1.02);} .btn:active{transform:scale(0.99);}
    .btn--primary{background:var(--c-primary);color:#083344;} .btn--navy{background:var(--c-navy);color:#fff;}
    .ripple{position:absolute;border-radius:50%;transform:scale(0);animation:ripple 500ms ease-out;background:rgba(255,255,255,.35);pointer-events:none;} @keyframes ripple{to{transform:scale(4);opacity:0}}
    .ui-input,.ui-select{width:100%;background:#fff;border:1px solid #e5e7eb;border-radius:12px;padding:.55rem .75rem;}
    .ui-input:focus,.ui-select:focus{border-color:var(--c-primary);box-shadow:0 0 0 3px rgba(118,202,227,.25);outline:none;}
    .ui-label{font-size:12px;color:#64748b;margin-bottom:.25rem;display:block;}
    .tabs{display:flex;gap:.5rem;flex-wrap:wrap;}
    .tab-btn{position:relative;padding:.5rem .8rem;border-radius:10px;background:#fff;border:1px solid #e5e7eb;color:#0b2e57;font-weight:600;transition:transform var(--transition),box-shadow var(--transition);}
    .tab-btn:hover{transform:translateY(-1px);box-shadow:var(--shadow);} .tab-btn.active{background:var(--c-navy);color:#fff;}
    .tab-btn.active::after{content:"";position:absolute;left:12px;right:12px;bottom:-2px;height:3px;border-radius:3px;background:linear-gradient(90deg,var(--c-primary),var(--c-lav));}
    .badge{display:inline-flex;align-items:center;padding:.2rem .6rem;border-radius:999px;font-weight:700;font-size:12px;}
    .badge--info{background:rgba(118,202,227,.15);color:#0b2e57;}
    .badge--success{background:rgba(66,183,126,.12);color:var(--c-mint);}
    .kpi-title{font-size:13px;color:#64748b;} .kpi-value{font-weight:700;font-size:18px;}
    .grid-cards{display:grid;gap:16px;} @media(min-width:768px){.grid-cards{grid-template-columns:repeat(2,minmax(0,1fr));}} @media(min-width:1024px){.grid-cards{grid-template-columns:repeat(4,minmax(0,1fr));}}
    .chart-h{height:320px;}
  </style>
</head>
<body>
  <div id="root" class="wrap max-w-[1200px] mx-auto"></div>

  <script type="text/babel" data-presets="react">
    if (!window.React || !window.ReactDOM || !window.Recharts || !window.PropTypes) {
      const e = document.createElement('div');
      e.style.cssText = 'max-width:800px;margin:24px auto;font-family:Roboto';
      e.innerHTML = '<div class="ui-card" style="padding:16px;"><div class="ui-title">We couldn’t load a library.</div><p class="ui-body">Refresh the page. If it persists, send me a Console screenshot.</p></div>';
      document.body.prepend(e);
      throw new Error('Libraries missing');
    }

    const { useState, useMemo, useEffect } = React;
    const { LineChart, Line, XAxis, YAxis, Tooltip, ResponsiveContainer, CartesianGrid, Legend } = Recharts;

    const months = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
    const fmtMoney = (n)=> (isFinite(n) ? n.toLocaleString(undefined,{style:'currency',currency:'USD',maximumFractionDigits:0}) : '—');
    const fmtInt   = (n)=> (isFinite(n) ? Math.round(n).toLocaleString() : '—');

    function useRipple(){
      useEffect(()=>{
        const onClick = (e)=>{
          const btn = e.target.closest('.btn'); if(!btn) return;
          const r = btn.getBoundingClientRect(); const size = Math.max(r.width, r.height);
          const s = document.createElement('span'); s.className='ripple';
          s.style.width=s.style.height=size+'px';
          s.style.left=(e.clientX - r.left - size/2)+'px';
          s.style.top =(e.clientY - r.top  - size/2)+'px';
          btn.appendChild(s); setTimeout(()=>s.remove(),500);
        };
        document.addEventListener('click', onClick);
        return ()=> document.removeEventListener('click', onClick);
      },[]);
    }

    /* ================== APP ================== */
    function WarGamePlanner(){
      useRipple();

      // ---- Inputs (same as before) ----
      const [npTarget, setNpTarget] = useState(1_000_000);
      const [revenuePerApprovedJob, setRevPerApprovedJob] = useState(653.6);
      const [approval, setApproval] = useState(0.55);
      const [gpPct, setGpPct] = useState(0.275);
      const [netMargin, setNetMargin] = useState(0.125);
      const [revenuePerPM, setRevenuePerPM] = useState(40000);

      const [dispatcherCapacityYear, setDispatcherCapacityYear] = useState(1440);
      const [tlPerDispatchers, setTlPerDispatchers] = useState(4);
      const [omPerTls, setOmPerTls] = useState(4);
      const [amPerPM, setAmPerPM] = useState(30);

      const [closeRate, setCloseRate] = useState(0.90);
      const [pmsPerAgency, setPmsPerAgency] = useState(4);
      const [meetingsPerMonth, setMeetingsPerMonth] = useState(4);

      const [totalAgencies, setTotalAgencies] = useState(1000);
      const [totalPMs, setTotalPMs] = useState(5800);

      const [useCustomSchedule, setUseCustomSchedule] = useState(true);
      const [schedule12, setSchedule12] = useState(Array(12).fill(4)); // Year1 schedule; repeats for Y2, Y3 in this phase

      // ---- Strategy presets (quick toggles) ----
      const presets = [
        { key:'base',  label:"Baseline",     gp:0.275, appr:0.55 },
        { key:'val+',  label:"Value+",       gp:0.24,  appr:0.65 },
        { key:'agg',   label:"Aggressive",   gp:0.22,  appr:0.70 },
        { key:'ultra', label:"Ultra-Value",  gp:0.20,  appr:0.75 },
      ];
      const [activePreset, setActivePreset] = useState(null);
      const applyPreset = (p)=>{ setGpPct(p.gp); setApproval(p.appr); setActivePreset(p.key); };

      // ================== CORE CALCS ==================
      // Build 36-month meeting plan (repeat Year1 schedule for Y2/Y3 for now)
      const meetings36 = useMemo(()=>{
        const base = useCustomSchedule ? schedule12 : Array(12).fill(meetingsPerMonth);
        return [...base, ...base, ...base]; // 36 months
      }, [schedule12, useCustomSchedule, meetingsPerMonth]);

      // Per-month outputs for 36 months
      const byMonth = useMemo(()=>{
        let cumRevenue = 0, cumNP = 0, cumPMs = 0;
        const out = [];
        for(let i=0;i<36;i++){
          const mtgs = meetings36[i];
          const agenciesWon = mtgs * closeRate;
          const pmsWon = agenciesWon * pmsPerAgency;
          const revenue = pmsWon * revenuePerPM;
          const gp = revenue * gpPct;
          const np = revenue * netMargin;
          cumPMs += pmsWon; cumRevenue += revenue; cumNP += np;
          out.push({
            idx:i,
            label:`Y${Math.floor(i/12)+1}-${months[i%12]}`,
            mtgs, agenciesWon, pmsWon, revenue, gp, np,
            cumRevenue, cumNP, cumPMs
          });
        }
        return out;
      }, [meetings36, closeRate, pmsPerAgency, revenuePerPM, gpPct, netMargin]);

      // Year slices
      const yearSlice = (y)=> byMonth.slice((y-1)*12, y*12);
      const totalsYear = (y)=> {
        const rows = yearSlice(y);
        return rows.reduce((a,b)=>({
          revenue:a.revenue+b.revenue,
          gp:a.gp+b.gp,
          np:a.np+b.np
        }), {revenue:0,gp:0,np:0});
      };
      const totalsAll = useMemo(()=> byMonth.reduce((a,b)=>({revenue:a.revenue+b.revenue,gp:a.gp+b.gp,np:a.np+b.np}), {revenue:0,gp:0,np:0}), [byMonth]);

      // Single-year target calcs (kept from original)
      const requiredRevenue = useMemo(()=> npTarget / netMargin, [npTarget, netMargin]);
      const pmsNeeded = useMemo(()=> requiredRevenue / revenuePerPM, [requiredRevenue, revenuePerPM]);
      const approvedJobs = useMemo(()=> requiredRevenue / revenuePerApprovedJob, [requiredRevenue, revenuePerApprovedJob]);
      const jobsSent = useMemo(()=> approvedJobs / approval, [approvedJobs, approval]);
      const dispatchers = useMemo(()=> Math.max(1, Math.ceil(jobsSent / dispatcherCapacityYear)), [jobsSent, dispatcherCapacityYear]);
      const tls = useMemo(()=> Math.max(1, Math.ceil(dispatchers / tlPerDispatchers)), [dispatchers, tlPerDispatchers]);
      const oms = useMemo(()=> Math.max(1, Math.ceil(tls / omPerTls)), [tls, omPerTls]);
      const ams = useMemo(()=> Math.max(1, Math.ceil(pmsNeeded / amPerPM)), [pmsNeeded, amPerPM]);

      // ================== UI STATE ==================
      const [tab, setTab] = useState("executive");
      const [timeframe, setTimeframe] = useState("year"); // 'year' | 'rolling'
      const [year, setYear] = useState(1); // Year picker for 'year' view

      // KPI helpers
      const kpi = useMemo(()=>{
        const tYear = totalsYear(year);
        return {
          year: tYear,
          rolling36: totalsAll
        };
      }, [year, totalsAll]);

      // ============== EXPORT CSV (kept) ==============
      const exportCSV = ()=>{
        const lines = [];
        lines.push("Section,Metric,Value");
        lines.push(`Target,NP Target,${npTarget}`);
        lines.push(`Target,Net Margin,${netMargin}`);
        lines.push(`Target,Required Revenue,${requiredRevenue}`);
        lines.push(`Target,Revenue/PM,${revenuePerPM}`);
        lines.push(`Target,PMs Needed,${pmsNeeded}`);
        lines.push(`Ops,Approval %,${approval}`);
        lines.push(`Ops,GP %,${gpPct}`);
        lines.push(`Ops,Jobs Approved,${approvedJobs}`);
        lines.push(`Ops,Jobs Sent,${jobsSent}`);
        lines.push(`Staff,Dispatchers,${dispatchers}`);
        lines.push(`Staff,Team Leaders,${tls}`);
        lines.push(`Staff,Ops Managers,${oms}`);
        lines.push(`Staff,Account Managers,${ams}`);
        lines.push("");
        lines.push("Monthly,Label,Meetings,Agencies Won,PMs Won,Revenue,GP,NP,Cum Revenue,Cum NP");
        byMonth.forEach(r=>{
          lines.push([r.label,r.mtgs,r.agenciesWon,r.pmsWon,r.revenue,r.gp,r.np,r.cumRevenue,r.cumNP].join(","));
        });
        const blob = new Blob([lines.join("\n")],{type:'text/csv;charset=utf-8;'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a'); a.href=url; a.download='ClassAFix_WarGame_Phase1.csv'; a.click();
        URL.revokeObjectURL(url);
      };

      /* ================== RENDER ================== */
      return (
        <div className="space-y-6">
          {/* Header */}
          <div className="flex items-center justify-between">
            <div>
              <div className="ui-title">Class A Fix — Growth War-Gaming</div>
              <div className="ui-sub mt-1">Phase 1: Dual timeframes + Executive KPIs</div>
            </div>
            <div className="flex items-center gap-2">
              <span className="badge badge--info">Internal</span>
              <button className="btn btn--primary" onClick={exportCSV}>Export CSV</button>
            </div>
          </div>

          {/* Controls (same spirit, trimmed) */}
          <div className="ui-card p-4 md:p-5">
            <div className="flex flex-wrap items-center gap-2 mb-4">
              <span className="ui-sub mr-2">Strategy:</span>
              {presets.map(p=>(
                <button key={p.key}
                        className={`btn ${activePreset===p.key? 'btn--navy':'btn--primary'}`}
                        onClick={()=> applyPreset(p)}>
                  {p.label}
                </button>
              ))}
            </div>

            <div className="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4">
              <div>
                <label className="ui-label">NP Target</label>
                <input className="ui-input" type="number" value={npTarget} onChange={(e)=>setNpTarget(Number(e.target.value))}/>
              </div>
              <div>
                <label className="ui-label">Net Margin %</label>
                <select className="ui-select" value={String(netMargin)} onChange={(e)=>setNetMargin(Number(e.target.value))}>
                  {[0.10,0.125,0.15,0.175].map(v=> <option key={v} value={String(v)}>{(v*100).toFixed(1)}%</option>)}
                </select>
              </div>
              <div>
                <label className="ui-label">Revenue per PM</label>
                <select className="ui-select" value={String(revenuePerPM)} onChange={(e)=>setRevenuePerPM(Number(e.target.value))}>
                  {[30000,40000,53000].map(v=> <option key={v} value={String(v)}>{v.toLocaleString(undefined,{style:'currency',currency:'USD',maximumFractionDigits:0})}</option>)}
                </select>
              </div>
              <div>
                <label className="ui-label">Revenue / Approved Job</label>
                <input className="ui-input" type="number" step="0.1" value={revenuePerApprovedJob} onChange={(e)=>setRevPerApprovedJob(Number(e.target.value))}/>
              </div>

              <div>
                <label className="ui-label">Approval %</label>
                <select className="ui-select" value={String(approval)} onChange={(e)=>setApproval(Number(e.target.value))}>
                  {[0.55,0.65,0.70,0.75].map(v=> <option key={v} value={String(v)}>{(v*100).toFixed(0)}%</option>)}
                </select>
              </div>
              <div>
                <label className="ui-label">Gross Profit %</label>
                <select className="ui-select" value={String(gpPct)} onChange={(e)=>setGpPct(Number(e.target.value))}>
                  {[0.275,0.24,0.22,0.20].map(v=> <option key={v} value={String(v)}>{(v*100).toFixed(1)}%</option>)}
                </select>
              </div>
              <div>
                <label className="ui-label">Close Rate in Meeting</label>
                <select className="ui-select" value={String(closeRate)} onChange={(e)=>setCloseRate(Number(e.target.value))}>
                  {[0.7,0.8,0.9,0.95].map(v=> <option key={v} value={String(v)}>{(v*100).toFixed(0)}%</option>)}
                </select>
              </div>
              <div>
                <label className="ui-label">PMs per Agency (avg)</label>
                <input className="ui-input" type="number" value={pmsPerAgency} onChange={(e)=>setPmsPerAgency(Number(e.target.value))}/>
              </div>

              <div className="flex items-center gap-2 mt-2">
                <input id="custom" type="checkbox" className="scale-110 accent-[var(--c-primary)]" checked={useCustomSchedule} onChange={(e)=> setUseCustomSchedule(e.target.checked)}/>
                <label htmlFor="custom" className="ui-sub">Use Custom Monthly Schedule</label>
                {useCustomSchedule ? <span className="badge badge--success">Custom</span> : <span className="badge badge--info">Default</span>}
              </div>
            </div>
          </div>

          {/* ===== Tabs ===== */}
          <div className="tabs">
            {[
              {id:'executive',label:'Executive'},
              {id:'dashboard',label:'Dashboard'},
              {id:'schedule',label:'Meetings Schedule'},
              {id:'matrix',label:'Meetings × PMs/Agency Matrix'},
              {id:'staffing',label:'Staffing'},
            ].map(t=>(
              <button key={t.id} className={`tab-btn ${tab===t.id?'active':''}`} onClick={()=> setTab(t.id)}>{t.label}</button>
            ))}
          </div>

          {/* ===== EXECUTIVE (new) ===== */}
          {tab==='executive' && (
            <div className="space-y-4">
              {/* Timeframe controls */}
              <div className="ui-card p-4 md:p-5">
                <div className="flex flex-wrap items-center gap-4">
                  <div className="ui-sub">Timeframe:</div>
                  <label className="flex items-center gap-2">
                    <input type="radio" name="tf" checked={timeframe==='year'} onChange={()=>setTimeframe('year')}/>
                    <span>Yearly (resets each Jan)</span>
                  </label>
                  <label className="flex items-center gap-2">
                    <input type="radio" name="tf" checked={timeframe==='rolling'} onChange={()=>setTimeframe('rolling')}/>
                    <span>Rolling (36 months)</span>
                  </label>

                  {timeframe==='year' && (
                    <div className="flex items-center gap-2">
                      <span className="ui-sub">Year:</span>
                      <select className="ui-select" style={{width:'120px'}} value={year} onChange={(e)=>setYear(Number(e.target.value))}>
                        {[1,2,3].map(y=> <option key={y} value={y}>Year {y}</option>)}
                      </select>
                    </div>
                  )}
                </div>
              </div>

              {/* KPI tiles */}
              <div className="grid-cards">
                <div className="ui-card p-4">
                  <div className="kpi-title">Revenue — {timeframe==='year'?`Year ${year}`:'Rolling 36mo'}</div>
                  <div className="kpi-value mt-1">{fmtMoney(timeframe==='year'? kpi.year.revenue : totalsAll.revenue)}</div>
                </div>
                <div className="ui-card p-4">
                  <div className="kpi-title">Gross Profit — {timeframe==='year'?`Year ${year}`:'Rolling 36mo'}</div>
                  <div className="kpi-value mt-1">{fmtMoney(timeframe==='year'? kpi.year.gp : totalsAll.gp)}</div>
                </div>
                <div className="ui-card p-4">
                  <div className="kpi-title">Net Profit — {timeframe==='year'?`Year ${year}`:'Rolling 36mo'}</div>
                  <div className="kpi-value mt-1">{fmtMoney(timeframe==='year'? kpi.year.np : totalsAll.np)}</div>
                </div>
                <div className="ui-card p-4">
                  <div className="kpi-title">All-time since launch (36mo) — NP</div>
                  <div className="kpi-value mt-1">{fmtMoney(totalsAll.np)}</div>
                </div>
              </div>

              {/* Trend line (matches selected timeframe) */}
              <div className="ui-card p-4 md:p-5">
                <div className="ui-sub mb-3">
                  {timeframe==='year' ? `Cumulative NP — Year ${year}` : 'Cumulative NP — Rolling 36 months'}
                </div>
                <div className="chart-h">
                  <ResponsiveContainer>
                    <LineChart data={timeframe==='year'? yearSlice(year).map((r,i)=>({...r, month:months[i]})) : byMonth}>
                      <CartesianGrid strokeDasharray="3 3" />
                      <XAxis dataKey={timeframe==='year'?'month':'label'} />
                      <YAxis />
                      <Tooltip formatter={(v)=> typeof v==='number' ? fmtMoney(v) : v} />
                      <Legend />
                      <Line type="monotone" dataKey="cumNP" name="Cum Net Profit" stroke="#1E3A8A" strokeWidth={2} dot={false}/>
                      <Line type="monotone" dataKey="cumRevenue" name="Cum Revenue" stroke="#76CAE3" strokeWidth={2} dot={false}/>
                    </LineChart>
                  </ResponsiveContainer>
                </div>
              </div>
            </div>
          )}

          {/* ===== Your existing tabs (trimmed in Phase 1, still useful) ===== */}
          {tab==='dashboard' && (
            <div className="ui-card p-4 md:p-5">
              <div className="ui-sub mb-3">Cumulative NP over the first 12 months (Year 1)</div>
              <div className="chart-h">
                <ResponsiveContainer>
                  <LineChart data={yearSlice(1).map((r,i)=>({...r, month:months[i]}))}>
                    <CartesianGrid strokeDasharray="3 3" />
                    <XAxis dataKey="month" />
                    <YAxis />
                    <Tooltip formatter={(v)=> typeof v==='number' ? fmtMoney(v) : v} />
                    <Legend />
                    <Line type="monotone" dataKey="cumNP" name="Cum Net Profit" stroke="#1E3A8A" strokeWidth={2} dot={false}/>
                    <Line type="monotone" dataKey="cumRevenue" name="Cum Revenue" stroke="#76CAE3" strokeWidth={2} dot={false}/>
                  </LineChart>
                </ResponsiveContainer>
              </div>
            </div>
          )}

          {tab==='schedule' && (
            <div className="ui-card p-4 md:p-5 space-y-4">
              <div className="ui-sub">Year 1 meetings (repeats for Years 2 & 3 in this phase)</div>
              <div className="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
                {months.map((m,i)=>(
                  <div key={m}>
                    <label className="ui-label">{m} — Meetings</label>
                    <input className="ui-input" type="number" value={schedule12[i]}
                           onChange={(e)=> setSchedule12(prev=> prev.map((x,idx)=> idx===i? Number(e.target.value): x))}/>
                  </div>
                ))}
              </div>
            </div>
          )}

          {tab==='matrix' && (
            <div className="ui-card p-4 md:p-5">
              <div className="ui-sub mb-3">Quick sensitivity: NP for Year 1 @ 4 PMs/agency baseline</div>
              <div className="chart-h">
                <ResponsiveContainer>
                  <LineChart data={months.map((m,i)=>({
                    month:m,
                    np: (schedule12[i]*closeRate*pmsPerAgency*revenuePerPM)*netMargin
                  }))}>
                    <CartesianGrid strokeDasharray="3 3" />
                    <XAxis dataKey="month" />
                    <YAxis />
                    <Tooltip formatter={(v)=> typeof v==='number' ? fmtMoney(v) : v} />
                    <Legend />
                    <Line type="monotone" dataKey="np" name="NP / month" stroke="#42B77E" strokeWidth={2} dot={true}/>
                  </LineChart>
                </ResponsiveContainer>
              </div>
            </div>
          )}

          {tab==='staffing' && (
            <>
              <div className="grid grid-cols-1 lg:grid-cols-2 gap-4">
                <div className="ui-card p-4 md:p-5 space-y-2">
                  <div className="ui-sub">Target-based single-year staffing (as before)</div>
                  <div className="grid grid-cols-2 gap-3">
                    <div><div className="kpi-title">Dispatchers</div><div className="kpi-value">{fmtInt(dispatchers)}</div></div>
                    <div><div className="kpi-title">Team Leaders</div><div className="kpi-value">{fmtInt(tls)}</div></div>
                    <div><div className="kpi-title">Ops Managers</div><div className="kpi-value">{fmtInt(oms)}</div></div>
                    <div><div className="kpi-title">Account Managers</div><div className="kpi-value">{fmtInt(ams)}</div></div>
                  </div>
                </div>

                <div className="ui-card p-4 md:p-5">
                  <div className="ui-sub">Rolling 36mo cumulative PMs</div>
                  <div className="chart-h">
                    <ResponsiveContainer>
                      <LineChart data={byMonth}>
                        <CartesianGrid strokeDasharray="3 3" />
                        <XAxis dataKey="label" />
                        <YAxis />
                        <Tooltip formatter={(v)=> typeof v==='number' ? (v>1000? fmtInt(v): v) : v} />
                        <Legend />
                        <Line type="monotone" dataKey="cumPMs" name="Cum PMs" stroke="#42B77E" strokeWidth={2} dot={false}/>
                      </LineChart>
                    </ResponsiveContainer>
                  </div>
                </div>
              </div>
            </>
          )}
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<WarGamePlanner />);
  </script>
</body>
</html>
